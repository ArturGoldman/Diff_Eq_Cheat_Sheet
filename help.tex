\documentclass[11pt]{article}
\usepackage{cmap}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}
\usepackage{textcomp}
\usepackage[left=10mm, top=20mm, right=10mm, bottom=20mm, nohead,
footskip=7mm]{geometry} 
\usepackage{amsmath}
\usepackage[T2A]{fontenc}
\usepackage{amssymb}
\usepackage{algorithm}
\usepackage{mathtools}
\usepackage[noend]{algpseudocode}
\usepackage{tikz-cd}
\usepackage{graphicx}
\usepackage{hyperref}
\usepackage{listings}
\usepackage{subfigure}
\usepackage{float}
\usepackage[shortlabels]{enumitem}


\newcommand{\intg}[2]{\displaystyle\int\limits_{#1}^{#2}}
\newcommand{\smm}[2]{\displaystyle\sum\limits_{#1}^{#2}}
\newcommand{\lmt}[2]{\lim\limits_{#1 \rightarrow #2}}
\newcommand{\nelb}[3]{\left. #1 \right|_{#2}^{#3}}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}


\title{Шпора}
\author{Диффуры}
\date{}

\begin{document}
	\maketitle
	\tableofcontents
	\begin{center}
		Внимание
	\end{center}

	Применяя данные методы не забываем проверять места, где мы потенциально делим на 0.
	
	Можно посмотреть ресурс EqWorld

	\section{Автономное уравнение}
	$$y' = f(x)$$
	Интегрируем

	\section{Разделяющиеся переменные}
	$$y' = f(x)g(y)$$
	$$\frac{dy}{g(y)} = f(x)dx$$
	Интегрируем

	\section{Однородные ДУ}
	$$y' = f(x, y) \ \text{и} \ f(mx, my) = f(x, y)$$
	Замена $z = \frac{y}{x},\ y = zx,\ y' = z + z'x$

	\section{Линейное ДУ}
	$$y' + p(x)y= g(x)$$
	\begin{enumerate}
		\item Решаем однородную часть $y' + p(x)y = 0$. Это ДУ с разделяющимися
		\item Вариация констант $c = c(x)$. Подставляем так, доделываем
	\end{enumerate}

	\section{Уравнения Бернулли}
	$$y' +p(x) y = q(x)y^n | :y^n$$
	$$\frac{y'}{y^n} + p(x)y^{1-n} = q(x)$$
	Замена $w = y^{1-n}$, $w' = (1-n)\frac{y'}{y^n}$. Получаем
	$$\frac{w'}{1-n} + p(x)w = q(x)$$
	Это линейное ДУ
	

	\section{Уравнения Рихкати}
	$$y' +a(x) y + b(x)y^2 = c(x)$$
	Если $y_1$ - частное решение, то делаем замену $z = y-y_1$. После этого по идее решается.

	\section{ДУ в полных производных}
	Предполагаем, что уравнение имеет вид
	$$F'_x dx + F'_y dy = 0$$
	Проверяем, совпадает ли $F_{xy} = F_{yx}$. Если да, то
	\begin{enumerate}
		\item Интегрируем одну из производных 
		$F(x) = \int F'_x dx = G(x) + C(y)$. Предполагаем, что константа - функция от $y$.
		\item Берем производную от всего, но уже по другой переменной и ищем такое $C(y)$, чтобы выполнялось $(G(x) + C(y))' = F'_y$. Далее уже дособираем ответ
	\end{enumerate}

	Если $F_{xy} \neq F_{yx}$, то начинаются танцы с интегрирующим множителем. Для этого пробуем выделять и собирать полные дифференциалы, например
	$$ydx - (x^3 y+x)dy = 0,\ (ydx - xdy) - x^3 ydy = 0 |: x^2$$
	
	Видно, что первой скобки не хватает знаменателя, чтобы свернуться в дифференциал. Поделим, преобразуем.
	$$\frac{ydx - xdy}{x^2} - xy dy = 0,\ -d(\frac{y}{x}) - xy dy = 0$$
	
	Немного сообразительности и вводим замену $z = \frac{y}{x}$. Тогда 
	$$-d(z) - \frac{y^2}{z} dy = 0,\ -y^2 dy = z dz$$
	
	Получили разделяющиеся переменные.

	\textit{Да как, блять, искать ваш интегрирующий множитель?} \\
	Есть алогритм, который может помочь нам делать это, но он не всегда работает. Для этого надо ввести функцию
	$\mu$, которая может быть трёх видов: $\mu(x), \ \mu(y), \ \mu(x, y)$. Именно на неё мы будем домножать. Итак, чтобы найти $\mu$, то делаем:
	$$F'_y \frac{\partial \mu}{\partial x} - F'_x \frac{\partial \mu}{\partial y} = \mu \bigg(\frac{\partial F'_x}{\partial y} - \frac{\partial F'_y}{\partial x}\bigg)$$
	Соответственно какое-то из слагаемых слева будет нулём (в зависимости от $\mu(x)$ или $\mu(y)$). Если $\mu = \mu(x)$:
	$$\frac{1}{\mu}\frac{\partial \mu}{\partial x} = \frac{1}{F'_y} \bigg(\frac{\partial F'_x}{\partial y} - \frac{\partial F'_y}{\partial x}\bigg)$$


	\section{ДУ Лагранжа / Клеро}
	$$y = f(y') x + g(y')$$
	
	ДУ Клеро - когда $f(y') = y'$. Предполагаем, что $y'_x = t,\ t = t(x)$. Тогда исходное уравнение имеет вид
	$$y = f(t) x + g(t),\ t = y'_x = f(t) + xf'_t(t)\cdot t'_x + t'_x\cdot g'_t(t) $$
	$$(xf'_t(t) + g'_t(t))t'_x = t - f(t)$$
	
	Если $t - f(t) \equiv 0$, то это как раз ДУ Клеро. Тут понятно. Иначе сводится к линейному ДУ.
	
	Ответ записываем в параметрическом виде, поэтому константы у переменных должны соответствовать.
	
	\textbf{Бонус 1:} Рссмотрим ДУ $y = xy' - x^2 (y')^3$. Оно не подходит под шаблон ДУ Лагранжа, но если сделать аналогичное предпложение $y' = p$, то в процессе получится свести к линейному относительно $x(p)$ и уравнение решится.
	
	\textbf{Бонус 2:} Иногда возможно решить уравнение относительно $y'$ и не надо никаких замен. При этом уравнение может совсем не соответствовать вид ДУ Лагранжа. Например:
	$$y'(2y - y') = y^2 \sin^2 x \text{ | квадратное уравнение относительно } y'$$ 
	$$(y')^3 + (x+2)e^y = 0 \text{ | y' просто выражается}$$ 

	\section{Однородное Линейное ДУ повышенного порядка с постоянными коэффициентами}
	$$a_{n} y^{(n)} +a_{n-1} y^{(n-1)} + \dots + a_{1} y' + a_{0} y = 0 $$
	Ищем корни в виде $y = Ce^{\lambda x}$Составляем характеристическое уравнение, решаем.
	\begin{enumerate}
		\item Вещественный корень $\lambda$ дает слагаемое $(C_1 + C_2 x + C_3 x^2 + \dots + C_n x^{n-1})e^{\lambda x}$ в ответ, где $n$ - кратность корня
		\item Т.к. мы рассматриваем многочлен в $\mathbb{R}[x]$, то пара (всегда пара) комплексных корней $a \pm bi$ дает слагаемое $e^a((C_{1, 1} + C_{1, 2} x + C_{1, 3} x^2 + \dots + C_{1, n} x^{n-1}) \cos(bx) + (C_{2, 1} + C_{2, 2} x + C_{2, 3} x^2 + \dots + C_{2, n} x^{n-1}) \sin(bx))$ в ответ, где $n$ - кратность корня.
		\item Ответ - сумма (линейная комбинация) написанных выше слагаемых.
		
	\end{enumerate}


	\section{Неднородное Линейное ДУ повышенного порядка с постоянными коэффициентами}
	$$a_{n} y^{(n)} +a_{n-1} y^{(n-1)} + \dots + a_{1} y' + a_{0} y = f(x) $$
	\begin{enumerate}
		\item Сначала решаем однородную часть, отбрасывая то, что находится справа.
		\item Ищем частное решение. Есть два пути:
			\begin{itemize}
				\item Если $f(x)$ собрано из функций $e^{ax}$, $\sin(bx)$, $\cos(mx)$, $P^n (x) \in \mathbb{R}[x]$ - многочлен степени $n$ путем применения операций $+,\ -,\ \cdot$ друг к другу и вещественным константам, то можно воспользоваться методом неопределенных кэффициентов путем применения соответствий
				$$P^n (x) \leftrightarrow a_n x^n + a_{n_1} x^{n-1} + \dots + a_1 x + a_0$$
				$$e^{\lambda x} \leftrightarrow ae^{\lambda x}$$
				$$\sin(bx),\ \cos (bx) \leftrightarrow A\sin(bx) + B\cos(bx)$$
				
				Синус и косинус одинаково представляются в общем виде. Не забываем учитывать кратность корня (в том числе и в решении однородной части) и домножать на нужный многочлен. 
				Например если в однородном решении был $(C_1 + xC_2)e^{2x}$ и $f(x) = P_m(x)e^{2x}$, то мы будем искать решение в виде $Q_m(x)x^2e^{2x}$. Так же $e^{0x}$ считается полиномом, про это тоже не забываем.
				\item Можно пользоваться стандартным методом вариации констант. Пусть решение однородной части имеет вид $y = C_1 y_1 +C_2 y_2 +\dots + C_n y_n$. Тогда мы должны решить систему
				
				$$\begin{pmatrix}
				y_1 & y_2 & \dots & y_n\\
				y'_1 & y'_2 & \dots & y'_n\\
				\vdots & \vdots & \ddots & \vdots\\
				y_1^{n-2} & y_2^{n-2} & \dots & y_n^{n-2}\\
				y_1^{n-1} & y_2^{n-1} & \dots & y_n^{n-1}
				\end{pmatrix}
				\begin{pmatrix}
				C_1'\\
				C_2'\\
				\vdots\\
				C_{n-1}'\\
				C_n'\\
				\end{pmatrix}=
				\begin{pmatrix}
				0\\
				0\\
				\vdots\\
				0\\
				\frac{f(x)}{a_n}\\
				\end{pmatrix}
				$$
				
				Для этого используем правило Крамера. Матрица слева называется матрицей Вронского, а определитель матрицы - Вронскиан
			\end{itemize}
		
	\end{enumerate}


	\section{Однородное Уравнение Эйлера}
	$$a_{n}x^n y^{(n)} +a_{n-1}x^{n-1} y^{(n-1)} + \dots + a_{1} xy' + a_{0} y = 0 $$
	
	Сводится к ОЛДУ с постоянными коэффициентами заменой $x = e^t$. Иногда работает и $y = x^k$.
	

	\section{Бонус ОЛДУ}
	
	$$a_2(x) y'' + a_1(x)y' + a_0 y = 0$$
	
	Пусть $y_1$ - частное решение. Тогда
	$$
	\begin{vmatrix}
	y_1 & y_2\\
	y_1' & y_2'
	\end{vmatrix} = C e^{-\int \frac{a_1(x)}{a_2(x)}dx }
	$$
	
	От сюда находится $y_2$ и итоговое решение равно $y = C_1 y_1 + C_2 y_2$. 
	
	Тут можно пытаться подобрать это частное решение как: многочлен в общем виде, либо (если старшие степени при иксах одинаковые) как экспонента $e^{ax}$.

	\section{Система ЛДУ}

Section under construction.
	
	Диагонализуя матрицу, мы сводим к случаю ОЛДУ но в векторной форме. Поэтому должно быть очевидно.
	При решении НСЛДУ вроде должно все получиться при вариации констант. Можно так же ставить соответствия, но это rip. \\

	Пусть у нас есть система (напишем для двух переменных)
	$$\begin{cases}
		\dot{x} = a_0x + b_0y + f_1(t) \\
		\dot{y} = a_1y + b_1y + f_2(t)
	\end{cases}$$
	\begin{itemize}
		\item Сначала решаем однородную часть. Для это запишем матрицу, соответствующей однородной части:
		$$A = \begin{pmatrix}
			a_0 & b_0 \\
			a_1 & b_1
		\end{pmatrix}$$
		Ищем собственные значения этой матрицы. Пусть они равны $\lambda_1, \ \lambda_2$. Ищем собственные вектора $v_1$ и $v_2$, соответствующие этим собственным 
		значением, тогда однородное решение будет
		$$\begin{pmatrix}
			x_o \\ y_o
		\end{pmatrix} = c_1e^{\lambda_1t}\cdot v_1 + c_2e^{\lambda_2t}\cdot v_2$$
		Если $\lambda_1 = \lambda_2$, это означает, что у нас будет не диагональна матрица, а жорданова клетка размера два. Тогда
		нам надо найти присоединенный вектор $u$, то есть вектор, являющийся собственным для матрицы $(A - \lambda E)^2$ и при этом
		$(A - \lambda E)u = v_1$. Тогда ответ запишется в виде 
		$$\begin{pmatrix}
			x_o \\ y_o
		\end{pmatrix} = c_1e^{\lambda t}\cdot v_1 + c_2e^{\lambda t}\cdot (u + t \cdot v_1)$$

		\item Теперь разбираемся с неоднородной частью. При этом $f(t) = e^{\alpha t}(P_m(t)\cos \beta t + Q_m(t)\sin \beta t)$. 
		Тогда мы допускаем, что частное решение $(x_1, \ y_1)^t$ будет примерно в таком же виде, при этом учитываем кратность корня $\alpha, \beta$. Я тут подразумеваю $f(t) = \begin{pmatrix}
			f_1(t) & f_2(t)
		\end{pmatrix}^t$

		Допустим $f(t) = P_m(t)e^{\alpha t}$ и в однородном решении был $e^{\alpha t}$, тогда ищем частное решение в виде $P_{m + k}(t)e^{\alpha t}$, где $k$- размер жордановой
		клетки для корня $\alpha$ (в нашем примере $k = 1$). Далее подставляем это решение и ищем методом неопр. коэффициентов.

		Допустим $f(t) = \cos \alpha t$, то ищем в виде $(a \cos \alpha t + b \sin \alpha t)$. 

		\item Ответ -- сумма однородного решения и частного решения.
	\end{itemize}
	
	
	
\end{document}
